{# partials/card_view_table.html #}
<div class="p-4 border rounded-lg shadow-sm bg-white overflow-x-auto">
  <table class="min-w-full divide-y divide-gray-200 text-sm">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-4 py-2 text-left" data-translate="home.card.component_no">Component No</th>
        <th class="px-4 py-2 text-left" data-translate="home.card.component_name">Component Name</th>
        <th class="px-4 py-2 text-left" data-translate="home.card.reason">Reason</th>
        <th class="px-4 py-2 text-left" data-translate="home.card.priority">Priority</th>
        <th class="px-4 py-2 text-left" data-translate="home.card.description">Description</th>
        <th class="px-4 py-2 text-left">Photos</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200">
    {% set ns = namespace(seen="") %}
    {% for c in p.components %}
        {% if ns.seen.find(c.component_no ~ "-" ~ c.reason) == -1 %}
        {% set ns.seen = ns.seen + c.component_no ~ "-" ~ c.reason ~ "," %}
        <tr>
            <td class="px-4 py-2">{{ c.component_no }}</td>
            <td class="px-4 py-2">{{ c.component_name }}</td>
            <td class="px-4 py-2">{{ c.reason }}</td>
            <td class="px-4 py-2">{{ c.priority }}</td>
            <td class="px-4 py-2 italic">{{ c.description or "-" }}</td>
            <td class="px-4 py-2">
              {% if c.photos and c.photos|length > 0 %}
                <div class="grid grid-cols-2 gap-2">
                  {% for photo in c.photos %}
                    <img src="{{ url_for('static', filename='files/uploads/' ~ p.df_filename.split('.')[0] ~ '/component_' ~ c.pc_id ~ '/pictures/' ~ photo) }}" 
                         class="rounded shadow object-cover w-20 h-20" alt="Component Photo">
                  {% endfor %}
                </div>
              {% else %}
                <span class="text-gray-400 text-xs">No photos</span>
              {% endif %}
            </td>
        </tr>
        {% endif %}
    {% endfor %}
    </tbody>
  </table>
</div>
